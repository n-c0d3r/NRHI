#pragma once

/** @file nrhi/utilities/platform_object_pool.hpp
*
*   Implement platform object pool.
*/



//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////



#pragma region Includes

////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////

#include <nrhi/prerequisites.hpp>

#pragma endregion



namespace nrhi {

	class A_device;



	namespace utilities {

		template<class F_pool__, typename F_platform_object__, typename F_input__>
		class TF_platform_object_pool {

		public:
			using F_pool = F_pool__;
			using F_platform_object = F_platform_object__;
			using F_input = F_input__;



		public:
			static inline F_platform_object acquire_object(TKPA_valid<A_device> device_p, const F_input& input) {

				if(F_pool__::default_input() == input)
					return F_pool__::default_object();

				return F_pool::create_object(device_p, input);
			}
			static inline void release_object(TKPA_valid<A_device> device_p, const F_input& input, F_platform_object platform_object) {

				if(F_pool__::default_object() == platform_object)
					return;

				F_pool::destroy_object(device_p, input, platform_object);
			}

		};

	}

}
